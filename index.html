<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teleprompter - Chá»n cháº¿ Ä‘á»™</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="index-container">
        <h1>ğŸ“º Teleprompter</h1>
        
        <div class="input-group">
            <label for="sheetUrl">URL Google Sheet (cÃ´ng khai):</label>
            <input 
                type="text" 
                id="sheetUrl" 
                placeholder="https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit"
                value=""
            >
            <div class="error-message" id="errorMessage"></div>
        </div>
        
        <div class="input-group">
            <label for="sessionId">Session ID (Ä‘á»ƒ káº¿t ná»‘i Remote - Ä‘á»ƒ trá»‘ng Ä‘á»ƒ táº¡o má»›i):</label>
            <input 
                type="text" 
                id="sessionId" 
                placeholder="Äá»ƒ trá»‘ng Ä‘á»ƒ táº¡o session má»›i"
                value=""
            >
        </div>
        
        <div class="button-group">
            <a href="#" class="btn btn-primary" id="btnTeleprompter">ğŸ“± Teleprompter</a>
            <a href="#" class="btn btn-secondary" id="btnRemote">ğŸ® Remote</a>
        </div>
        
        <div class="loading" id="loading" style="display: none;">
            Äang táº£i dá»¯ liá»‡u tá»« Google Sheet...
        </div>
    </div>

    <script src="js/sheets.js"></script>
    <script>
        const sheetUrlInput = document.getElementById('sheetUrl');
        const sessionIdInput = document.getElementById('sessionId');
        const btnTeleprompter = document.getElementById('btnTeleprompter');
        const btnRemote = document.getElementById('btnRemote');
        const errorMessage = document.getElementById('errorMessage');
        const loading = document.getElementById('loading');

        // Kiá»ƒm tra náº¿u cÃ³ session ID trong localStorage
        const savedSession = localStorage.getItem('teleprompter_session');
        if (savedSession && !sessionIdInput.value) {
            sessionIdInput.value = savedSession;
        }

        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.add('show');
        }

        function hideError() {
            errorMessage.classList.remove('show');
        }

        function validateAndNavigate(mode) {
            const sheetUrl = sheetUrlInput.value.trim();
            const sessionId = sessionIdInput.value.trim();

            hideError();

            if (!sheetUrl) {
                showError('Vui lÃ²ng nháº­p URL Google Sheet');
                return;
            }

            if (!validateSheetUrl(sheetUrl)) {
                showError('URL khÃ´ng há»£p lá»‡. Vui lÃ²ng nháº­p URL Google Sheets Ä‘Ãºng Ä‘á»‹nh dáº¡ng.');
                return;
            }

            // LÆ°u sheet URL vÃ o localStorage
            localStorage.setItem('teleprompter_sheet_url', sheetUrl);

            // Táº¡o URL vá»›i tham sá»‘
            let url = mode === 'teleprompter' ? 'teleprompter.html' : 'remote.html';
            url += '?sheet=' + encodeURIComponent(sheetUrl);
            
            if (sessionId) {
                url += '&session=' + encodeURIComponent(sessionId);
                localStorage.setItem('teleprompter_session', sessionId);
            }

            window.location.href = url;
        }

        btnTeleprompter.addEventListener('click', (e) => {
            e.preventDefault();
            validateAndNavigate('teleprompter');
        });

        btnRemote.addEventListener('click', (e) => {
            e.preventDefault();
            validateAndNavigate('remote');
        });

        // Enter key Ä‘á»ƒ submit
        sheetUrlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                validateAndNavigate('teleprompter');
            }
        });
    </script>
</body>
</html>

